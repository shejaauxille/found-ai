<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Found AI | Advanced Reunification</title>

  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>

  <style>
    :root {
      --bg: #0b0f1a;
      --card: rgba(255,255,255,0.06);
      --border: rgba(255,255,255,0.12);
      --text: #eaeaf0;
      --muted: #9aa4bf;
      --blue: #4f7cff;
      --green: #27ff9b;
      --purple: #9b7bff;
      --gradient: linear-gradient(135deg, #4f7cff, #9b7bff, #27ff9b);
    }

    * { box-sizing: border-box; scroll-behavior: smooth; }
    body { margin: 0; min-height: 100vh; font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); display: flex; justify-content: center; overflow-x: hidden; }
    
    .container { width: 100%; max-width: 900px; padding: 50px 20px; }
    header { text-align: center; margin-bottom: 50px; }
    header h1 { font-size: 3.5rem; background: var(--gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin: 0; font-weight: 800; letter-spacing: -1px; }
    header p { color: var(--muted); font-size: 1.1rem; margin-top: 10px; }

    /* Selection Cards */
    .selection-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 40px; }
    .choice-card { background: var(--card); border: 1px solid var(--border); border-radius: 20px; padding: 35px; text-align: center; cursor: pointer; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
    .choice-card:hover { transform: translateY(-8px); background: rgba(255,255,255,0.1); border-color: var(--blue); }
    .choice-card.active { border-color: var(--blue); background: rgba(79, 124, 255, 0.08); box-shadow: 0 10px 30px rgba(79, 124, 255, 0.2); }
    .icon { font-size: 45px; margin-bottom: 15px; display: block; }

    /* Form Styles */
    .form-container { display: none; background: var(--card); border: 1px solid var(--border); border-radius: 24px; padding: 40px; margin-top: 20px; backdrop-filter: blur(10px); animation: slideIn 0.5s ease; }
    @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

    .input-group { margin-bottom: 20px; }
    label { display: block; margin-bottom: 10px; font-size: 0.9rem; color: var(--muted); font-weight: 500; }
    input { width: 100%; padding: 16px; border-radius: 14px; border: 1px solid var(--border); background: rgba(0,0,0,0.2); color: white; font-size: 1rem; transition: 0.3s; }
    input:focus { outline: none; border-color: var(--blue); box-shadow: 0 0 0 4px rgba(79, 124, 255, 0.1); }

    /* Interactive Previews */
    .preview-box { width: 100%; height: 200px; border-radius: 14px; border: 2px dashed var(--border); margin-bottom: 20px; display: flex; align-items: center; justify-content: center; overflow: hidden; background: rgba(0,0,0,0.1); }
    .preview-img { width: 100%; height: 100%; object-fit: cover; display: none; }

    /* Buttons & Feedback */
    button { width: 100%; padding: 18px; border-radius: 16px; border: none; font-weight: 700; cursor: pointer; font-size: 1.1rem; transition: 0.3s; display: flex; align-items: center; justify-content: center; gap: 10px; }
    .btn-missing { background: linear-gradient(135deg, #4f7cff, #9b7bff); color: white; }
    .btn-found { background: linear-gradient(135deg, #27ff9b, #18c27a); color: #04150e; }
    button:disabled { opacity: 0.6; cursor: not-allowed; transform: none !important; }
    button:hover { transform: scale(1.02); filter: brightness(1.1); }

    .status-msg { margin-top: 25px; padding: 18px; border-radius: 14px; text-align: center; border: 1px solid var(--border); font-weight: 600; min-height: 60px; transition: 0.3s; }
    
    /* Animations */
    .spinner { width: 22px; height: 22px; border: 3px solid rgba(255,255,255,0.3); border-top-color: #fff; border-radius: 50%; animation: spin 0.8s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .pulse { animation: pulseAnim 1.5s infinite; }
    @keyframes pulseAnim { 0% { opacity: 1; } 50% { opacity: 0.6; } 100% { opacity: 1; } }
  </style>
</head>
<body>

<div class="container">
  <header>
    <h1>Found AI</h1>
    <p>Using Multimodal AI to reunite families instantly</p>
  </header>

  <div class="selection-grid">
    <div class="choice-card" id="btn-show-missing" onclick="toggleForm('missing')">
      <span class="icon">üîç</span>
      <h3>Missing Person</h3>
      <p>Register a loved one's face in our global database</p>
    </div>
    <div class="choice-card" id="btn-show-found" onclick="toggleForm('found')">
      <span class="icon">ü§ù</span>
      <h3>Found Someone</h3>
      <p>Scan a person to find their family and location</p>
    </div>
  </div>

  <div id="form-missing" class="form-container">
    <h2 style="margin-top:0">Register Missing Person</h2>
    <div class="input-group"><label>Full Name</label><input type="text" id="name" placeholder="Name of missing person"></div>
    <div class="input-group"><label>Contact Person</label><input type="text" id="contact" placeholder="Guardian or relative name"></div>
    <div class="input-group"><label>Emergency Email</label><input type="email" id="email" placeholder="family@contact.com"></div>
    
    <label>Upload Clear Photo (Face must be visible)</label>
    <div class="preview-box">
      <span id="missing-placeholder" style="color:var(--muted)">No image selected</span>
      <img id="missing-preview" class="preview-img">
    </div>
    <input type="file" id="missing-photo" accept="image/*" onchange="previewFile('missing')" style="margin-bottom:20px">
    
    <button class="btn-missing" onclick="addMissingPerson()">
      <span id="m-btn-text">Register Database</span>
    </button>
    <div id="status" class="status-msg">System ready for registration...</div>
  </div>

  <div id="form-found" class="form-container">
    <h2 style="margin-top:0">Scan Found Person</h2>
    <div class="input-group"><label>Your Contact Email (Finder)</label><input type="email" id="finder-email" placeholder="your@email.com"></div>
    
    <label>Photo of the person you found</label>
    <div class="preview-box">
      <span id="found-placeholder" style="color:var(--muted)">No image selected</span>
      <img id="found-preview" class="preview-img">
    </div>
    <input type="file" id="found-photo" accept="image/*" onchange="previewFile('found')" style="margin-bottom:20px">
    
    <button class="btn-found" onclick="checkFoundPerson()">
      <span id="f-btn-text">Start AI Recognition</span>
    </button>
    <div id="result" class="status-msg">Waiting for person scan...</div>
  </div>
</div>

<script type="importmap">
{
  "imports": {
    "@google/generative-ai": "https://esm.run/@google/generative-ai"
  }
}
</script>
<script src="script.js"></script>

<script>
  // UI Function: Toggle between the two forms
  function toggleForm(type) {
    document.getElementById('form-missing').style.display = 'none';
    document.getElementById('form-found').style.display = 'none';
    document.getElementById('btn-show-missing').classList.remove('active');
    document.getElementById('btn-show-found').classList.remove('active');

    const form = document.getElementById('form-' + type);
    form.style.display = 'block';
    document.getElementById('btn-show-' + type).classList.add('active');
    form.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }

  // UI Function: Image Previews
  function previewFile(type) {
    const file = document.getElementById(type + '-photo').files[0];
    const preview = document.getElementById(type + '-preview');
    const placeholder = document.getElementById(type + '-placeholder');
    
    if (file) {
      const reader = new FileReader();
      reader.onloadend = function () {
        preview.src = reader.result;
        preview.style.display = 'block';
        placeholder.style.display = 'none';
      }
      reader.readAsDataURL(file);
    }
  }
</script>
</body>
</html>
